\documentclass[handout,8pt]{beamer}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage[bottom]{footmisc}
\usepackage{float}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[french]{babel} 
\usepackage{color}
\usepackage{fancyhdr}
\usepackage{lmodern} 
\usepackage{makeidx}

\usetheme{Warsaw}


\title{Modélisation du transport d'un polluant}

% A subtitle is optional and this may be deleted
\subtitle{Projet d'introduction à la recherche}

\author{Léo Baty, Chiheb Eddine Najjar,
	Nathan Godey, Régis Santet, Song Phuc Duong, Clément Lasuen\\ sous la direction de \\
	Damiano Lombardi et Sebastien Boyaval \\ Laboratoire INRIA}

\setbeamertemplate{footline}[frame number]
\setbeamertemplate{caption}[numbered]

\date{ \today}



\AtBeginSubsection[]
{
	\begin{frame}<beamer>{Sommaire}
		\tableofcontents[currentsection,currentsubsection,hideallsubsections]
	\end{frame}
}

% Let's get started
\begin{document}
	
	\begin{frame}
		\titlepage
	\end{frame}
	
	\begin{frame}{Sommaire}
		\tableofcontents
		% You might wish to add the option [pausesections]
	\end{frame}
	
	% Section and subsections will appear in the presentation overview
	% and table of contents.
	\section{Introduction}
	
	
	\begin{frame}{Introduction}
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.15]{deepwater_horizon_explosion.jpg}
				\caption{Explosion de \emph{Deepwater Horizon, 20/04/2010}}
			\end{center}
		\end{figure}
		
	\end{frame}
	
	\begin{frame}{Equation de transport}
		
		\begin{center}
			\fbox{$\partial_tc+u \cdot \nabla c = 0$}
		\end{center}
		c(x,t) : concentration en polluant à la position $x \in (0,1)^2 = \Omega$ à l'instant $t \in [0,T]$ \\
		u : champ de vitesse, dépend \emph{a priori} de $x$ et de $t$
	\end{frame}
	
	
	
	\section{M\'ethodes}
	
	
	\subsection{Champs de vitesse étudiés}
	
	% You can reveal the parts of a slide one at a time
	% with the \pause command:
	\begin{frame}{Champs de vitesse étudiés}{Champ de vitesse uniforme}
		
		$$\left\{\begin{array}{c c c}
		u_x = ||u||\cos(\theta)\\
		u_y = ||u||\sin(\theta)
		\end{array}\right.$$ 
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.30]{lagrange_gauss_1er_mode.png}
				\caption{Écoulement constant avec un angle $\theta$}
			\end{center}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Champs de vitesse étudiés}{Écoulements cellulaires}
		\begin{center}
			$\psi(x,y) = \sin(2\pi x) \sin(2\pi y) + \theta_0 \cos(2\pi\theta_1x)\cos(2\pi \theta_2y)$\\
			$\theta_0 \in [0,2.5]$ et $(\theta_1,\theta_2) \in [0.5,4]^2$
		\end{center}
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=5cm]{ecoulement_cellulaire.pdf}
			\includegraphics[width=5cm]{ecoulement_cellulaire2.pdf}
			\caption{Champs de vitesse pour deux jeux de param\`etres}
		\end{figure}
		
	\end{frame}
	
	\begin{frame}{Champs de vitesse étudiés}{Champ de vitesse de Lamb-Oseen}
		$$ \mathbf{V}(r,\theta,t) = \frac{\Gamma}{2\pi r}\left(1 - \exp\left( \frac{-r^2}{4\nu t + r_c^2}\right)\right)\mathbf{u_{\theta}}$$
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.30]{lagrange_lamboseen.png}
				\caption{Écoulement Lamb-Oseen}
			\end{center}
		\end{figure}
	\end{frame}
	% Placing a * after \section means it will not show in the
	% outline or table of contents.
	
	\subsection{Approche eulerienne}
	\begin{frame}{Approche eulerienne}
		
		\begin{figure}
			\includegraphics[width=0.7\linewidth]{euler_condition_initiale}
			\caption{Condition initiale...}
		\end{figure}
		
	\end{frame}
	
	\begin{frame}{Approche eulerienne}
		\begin{figure}
			\includegraphics[width=0.7\linewidth]{euler_condition_initiale_simulee}
			\caption{... et après un certain temps}
		\end{figure}
	\end{frame}
	

	

	
	
	
	\subsection{Approche lagrangienne}
	\begin{frame}{Approche lagrangienne}
		$X(\xi,t) \in \mathbb{R}^{n\times2}$ désigne les positions, à l'instant $t\in [0,T]$, des particules 
		qui étaient initialement aux positions $\xi \in \mathbb{R}^{n\times2}$
		$$
		\left\{
		\begin{array}{c c c}
		\partial_tX  =  v(X(\xi,t),t)\\
		X(\xi,0)  =  \xi
		\end{array}
		\right.
		$$ 
		
	\end{frame}
	
	
	\begin{frame}
		\begin{exampleblock}{Hypothèses}
			$v \in\mathcal{C}^0(\mathbb{R}^{n\times2} \times \mathbb{R}) \bigcap W^{1,\infty}(\mathbb{R}^{n\times2} \times \mathbb{R}) $
		\end{exampleblock}
		\begin{exampleblock}{Théorème de Cauchy-Lipschitz}
			Existence et unicité d'une solution locale pour des temps arbitraires
		\end{exampleblock}
		\begin{exampleblock}{Conséquence}
			Le transport est à vitesse finie
		\end{exampleblock}
	\end{frame}
	
	\begin{frame}{Approche lagrangienne}{Résolution numérique}
		Schéma de Crank-Nicholson :
		
		$$X^{(k+1)} = X^{(k)} + \frac{\Delta t}{2}(v(X^{(k)},t^k) + v(X^{(k+1)},t^{k+1}))$$
		
		Algorithme du point fixe : 
		
		$$
		\left\{
		\begin{array}{c c c}
		X^{(k+1)}_0 = X^{(k)}\\
		X^{(k+1)}_1 = X^{(k)} + \Delta t v(X^{(k)},t^k) \\
		X^{(k+1)}_{r+1} = X^{(k)} + \frac{\Delta t}{2}(v(X^{(k)},t^k) + v(X^{(k+1)}_r,t^{k+1}))
		\end{array}
		\right.
		$$
	\end{frame}

		\begin{frame}{Approche eulerienne}{Méthode des volumes finis}
		\begin{figure}
			\includegraphics[scale = 0.5]{maillage_en_espace.png}
			\caption{Maillage en espace}
		\end{figure}
		
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Méthode des volumes finis}
		la valeur moyenne de $c$ sur la cellule $K_{i,j}$. 
		\begin{equation*}
		c_{i,j}(t) =\frac{1}{\vert K_{i,j} \vert}\int_{K_{i,j}} c(t,X) dX
		\end{equation*}
		vérifie :
		$$
		\frac{\partial c_{i,j}}{\partial t} +  \frac{1}{\vert K_{i,j} \vert} \int_{\partial K_{i,j} } c \ u \cdot n \ dL = 0
		$$
		\begin{itemize}
			\item Comment discrétiser la dérivation temporelle ?
			\item Comment discrétiser l'intégrale de bords (le flux)?
		\end{itemize}
	\end{frame}
	
	
	
	\begin{frame}{Approche eulerienne}{Méthode des volumes finis}
		La dérivée temporelle : Euler explicite
		$$ 
		\frac{\partial c_{i,j}}{\partial t} \simeq \frac{c_{i,j}(t_n) - c_{i,j}(t_{n-1})}{t_n - t_{n-1}}
		$$
		Maillage en temps : $(t_n)_{n=0}^{n_t}$ croissante, vérifiant la condition CFL:
		\begin{equation}
		t_n - t_{n-1} < \frac{h}{2 \lambda(t_n) }
		\end{equation}
		où $\lambda(t_n) = \max_{X} \lbrace\vert u(t_n)\vert  \rbrace$, et $ h = \min \lbrace \Delta x , \Delta y \rbrace$\\
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Méthode des volumes finis}
		Le flux : Lax-Friedrichs \\
		$$\int_{\partial K_{i,j} } c \ u \cdot n \ dL$$ 
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Méthode des volumes finis}
		
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{flux.png}
			\end{center}
		\end{figure}
	\end{frame}
	
	
	\begin{frame}{Approche eulerienne}{Méthode des volumes finis}
		
		
		Finalement on combine les 2 schémas : 
		
		\begin{equation}
		c_{i,j}(t_n) = c_{i,j}(t_{n-1}) - \frac{\Delta t_n}{\vert K_{i,j} \vert}  \sum_{\mathrm{cotés}} \vert \Gamma \vert F_i \ \forall n
		\end{equation}
		
	\end{frame}
	
	\subsection{Proper Orthogonal Decomposition}
	
		\begin{frame}{Proper Orthogonal Decomposition}{La POD}
		On stocke les résultats obtenus (i.e. les vecteurs $C(t_n)=(c_{ij}(t_n))$ par la méthode des volumes finis pour un champs de vitesse $v_1$ dans une matrice 
		$$
		M_{v_1} = (C(t_0)_{v1} \vert \dots \vert C(t_f)_{v1} )
		$$
		On répète ça pour plusieurs champs de vitesse $v_i$ et on met tout dans une grosse matrice 
		$$
		M = (M_{v_1} \vert M_{v_2} \vert \dots \vert M_{v_f} )
		$$
		\textbf{Décomposition en valeurs singulières : } $M = U D V^T$
		\begin{itemize}
			\item Unicité de la décomposition si on impose des valeurs singulières décroissantes à $D$
			\item $U,V$ matrices unitaires $UU^T = I$ et $VV^T=I$ 
		\end{itemize}
	\end{frame}
	
	
	\begin{frame}{Proper Orthogonal Decomposition}{Modèle réduit}
		la base orthonormée, obtenue par la POD : $(P_i)_{i=1}^r$, 
		$$
		U_r  = ( P_1 \vert P_2 \vert \dots \vert P_r)
		$$
		
		\begin{itemize}
			\item projection d'un vecteur $C=(c_{ij})$ de la base de données sur cette base :
			$$
			C_p = U_r U_r^T C
			$$
			Théoriquement l'erreur est de l'ordre de
			$$\sum_{i>r} D_{i,i}^2$$
		\end{itemize}
		
	\end{frame}
	
	
	\begin{frame}{Proper Orthogonal Decomposition}{Modèle réduit}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.4]{projection.png}
			\end{center}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Proper Orthogonal Decomposition}{Modèle réduit}
		\begin{itemize}
			\item Construire des nouvelles solutions pour un autre choix de paramètres notamment le champs de vitesse
			$$C(t) = U_r \cdot A(t)$$
			$A(t)$ vérifie :
			$$
			\partial_t A(t) + D_{v,r} \cdot A(t) = 0
			$$
			qu'on peut discrétiser avec un schéma d'Euler Implicite 
			$$
			\frac{A(t_n)-A(t_{n-1})}{t_n - t_{n-1}} + D_{v,r} \cdot A(t_n) = 0
			$$
		\end{itemize}
	\end{frame}
	
	
	
	\section{Résultats et interprétations}
	
	\subsection{Approche eulerienne}
	\subsubsection{Champ de vitesse uniforme}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		
		$16$ simulations, $\theta\in[0,\frac{\pi}{2}]$
		
		\begin{figure}[H]
			\centering
			\includegraphics[width=0.7\linewidth]{valeurs_singulieres_eulerien_constant}
			\caption{Tracé du $\log$ des valeurs singulières en fonction du rang}
			\label{fig:valeurssinguliereseulerienconstant}
		\end{figure}
		
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		Rôle des modes propres :
		
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_mode_1} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_mode_2}\\
		\end{tabular}
	\end{frame}
	
	\begin{frame}
		
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_mode_10} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_mode_50}\\
		\end{tabular}
		
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		Reconstruction d'une solution fine\\
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_condition_initiale_10modes} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_condition_initiale_20modes}\\
			Condition initiale, 10 modes & Condition initiale, 20 modes
		\end{tabular}
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		Reconstruction d'une solution fine\\
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_condition_initiale_50modes} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_condition_initiale_100modes}\\
			Condition initiale, 50 modes & Condition initiale, 100 modes
		\end{tabular}
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		Reconstruction d'une solution fine\\
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_condition_initiale_200modes} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_condition_initiale_500modes}\\
			Condition initiale, 200 modes & Condition initiale, 500 modes
		\end{tabular}
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		Reconstruction d'une solution fine\\
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_moment_random_10modes} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_moment_random_20modes}\\
			A mi-parcours, 10 modes & A mi-parcours, 20 modes
		\end{tabular}
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		Reconstruction d'une solution fine\\
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_moment_random_50modes} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_moment_random_100modes}\\
			A mi-parcours, 50 modes & A mi-parcours, 100 modes
		\end{tabular}
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Champ de vitesse uniforme}
		Reconstruction d'une solution fine\\
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_moment_random_200modes} &	\includegraphics[width=0.5\linewidth]{eulerien_constant_reproduction_moment_random_500modes}\\
			A mi-parcours, 200 modes & A mi-parcours, 500 modes
		\end{tabular}
	\end{frame}
	
	\subsubsection{Écoulements cellulaires}
	
	
	\begin{frame}{Approche eulerienne}{Ecoulements cellulaires}
		\begin{block}{64 simulations en volumes finis}
			\begin{itemize}
				\item On se place sur $[-0.5,1.5]\times[-0.5,1.5]$
				\item Maillage de $2^7$ mailles de c\^ot\'e
				\item $(x_0,y_0,\theta_0)\in [0.25,0.75]\times[0.25,0.75]\times[0,2.5]$ tir\'es uniform\'ement
			\end{itemize}
		\end{block}
		\begin{figure}[H]
			\centering
			\includegraphics[width=6cm]{valeurs_singulieres_eulerien_cellulaire.png}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Ecoulements cellulaires}
		Reconstruction "in-range" : 
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{fin_fine.png} &	\includegraphics[width=0.5\linewidth]{fin200modes.png}\\
			Snapshot \`a mi-parcours, 200 modes & A mi-parcours, 200 modes
		\end{tabular}
	\end{frame}
	
	
	\begin{frame}{Approche eulerienne}{Ecoulements cellulaires}
		Reconstruction "out of range" : 
		\begin{tabular}{cc}
			\includegraphics[width=0.5\linewidth]{outfin.png} &	\includegraphics[width=0.5\linewidth]{outfin500modes.png}\\
			Snapshot \`a mi-parcours, 500 modes & A mi-parcours, 200 modes
		\end{tabular}
	\end{frame}
	
	\begin{frame}{Approche eulerienne}{Ecoulements cellulaires}
		\begin{block}{Prise en en compte de la positivit\'e de la concentration}
			Recherche des coefficients $(a_j)_j$ tels que : 
			$$(a_j)_j=\text{argmin} \|c_{*}-\sum\limits_j a_j\varphi_j \|_{L^2} \text{ s.c. } \sum\limits_j a_j\varphi_j\geq0$$
		\end{block}
		\begin{figure}[H]
			\centering
			\includegraphics[width=5cm]{opticell2.png}
			\includegraphics[width=5cm]{opticell1.png}
		\end{figure}
	\end{frame}
	
	\subsection{Approche lagrangienne}
	\subsubsection{Champ de vitesse uniforme}
	\begin{frame}{Approche lagrangienne}{Champ de vitesse uniforme}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.40]{valeurs_singulieres_v_cste_8000_particules_rond.png}
				\caption{$\log$ des valeurs singulières pour 8000 particules}
			\end{center}
		\end{figure}
	\end{frame}
	
	\subsubsection{Écoulements cellulaires}
	
	\begin{frame}{Approche lagrangienne}{Écoulements cellulaires}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.45]{lagrange_cell_variation_parametres.png}
				\caption{$\log$ des valeurs singulières pour 500 particules}
			\end{center}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Approche lagrangienne}{Écoulements cellulaires}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.40]{cell_0.png}
				\caption{simulation pour 100 particules, $\theta_0 = \theta_1 =\theta_2=0.5$}
			\end{center}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Approche lagrangienne}{Écoulements cellulaires}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.40]{cell_1.png}
				\caption{simulation pour 100 particules, $\theta_0 = \theta_1 =\theta_2=0.5$}
			\end{center}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Approche lagrangienne}{Écoulements cellulaires}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.40]{cell_2.png}
				\caption{simulation pour 100 particules, $\theta_0 = \theta_1 =\theta_2=0.5$}
			\end{center}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Approche lagrangienne}{Écoulements cellulaires}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.40]{cell_3.png}
				\caption{simulation pour 100 particules, $\theta_0 = \theta_1 =\theta_2=0.5$}
			\end{center}
		\end{figure}
	\end{frame}
	
	\begin{frame}{Approche lagrangienne}{Écoulements cellulaires}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.40]{lagrange_premier_mode_propre_lambo.png}
				\caption{Projection selon le premier mode propre}
			\end{center}
		\end{figure}
	\end{frame}
	\subsubsection{Champ de vitesse de Lamb-Oseen}
	
	\begin{frame}{Approche lagrangienne}{Champ de vitesse de Lamb-Oseen}
		\begin{figure}[H]
			\begin{center}
				\includegraphics[scale=0.45]{valeurs_singulieres_lambo_100_particules.png}
				\caption{$\log$ des valeurs singulières pour 100 particules}
			\end{center}
		\end{figure}
	\end{frame}
	
	\section{Conclusion}
	
	\begin{frame}{Conclusion}{R\'esultats}
		\begin{block}{Approche eulerienne}
			\begin{itemize}
				\item Mod\`ele r\'eduit efficace pour des param\`etres "in-range"
				\item Limites pour des param\`etres "out of range"
				\item Probl\`emes de positivit\'e de la solution
			\end{itemize}
			$\implies$ besoin d'un grand nombre de modes et de bien choisir le domaine de param\`etres pour \^etre pr\'ecis 
		\end{block}
		\begin{block}{Approche lagrangienne}
			\begin{itemize}
				\item Approche plus efficace pour un champ de vitesse constant et Lamboseen
				\item Approche tr\`es limit\'ee pour un \'ecoulement cellulaire, du aux multiples trajectoires radicalement diff\'erentes
			\end{itemize}
			$\implies$ besoin de trajectoires pas trop changeantes pour \^etre efficace
			
		\end{block}
	\end{frame}
	
	\begin{frame}{Conclusion}{Perspectives}
		\begin{block}{Approche eulerienne et lagrangienne}
			\begin{itemize}
				\item Utilisation de sch\'ema non-lin\'eaires et plus pr\'ecis pour r\'esoudre le probl\`eme fin
				\item Dynamique r\'eduite par m\'ethode de Galerkine, afin de verifier l'efficacit\'e de la POD
				\item Probl\`eme de la positivit\'e de la solution
			\end{itemize}
		\end{block}
	\end{frame}
	
	
	
	% All of the following is optional and typically not needed. 
	\appendix
	\section<presentation>*{\appendixname}
	\subsection<presentation>*{Références}
	
	\begin{frame}[allowframebreaks]
		\frametitle<presentation>{Références}
		
		\begin{thebibliography}{10}
			
			\setbeamertemplate{bibliography item}[triangle]
			
			\bibitem{Cours1}
			V. Ehrlacher, S.Boyaval
			\newblock {\em Méthodes numériques pour les problèmes en grande dimension}.
			\newblock Cours de l'École nationale des ponts et chaussées, 2018.
			
			\bibitem{Cours2}
			S.Boyaval
			\newblock{\em Numerical Hydrodynamics for the environment Illustrated by river flows}
			\newblock Cours de l'École nationale des ponts et chaussées, 2018.
			
			
			\setbeamertemplate{bibliography item}[article]
			% Followed by interesting articles. Keep the list short. 
			
			\bibitem{article}
			E.Bruman
			\newblock{\em Consistent SUPG-method for transient transport problems: Stability and convergence}
			\newblock Comput. Methods Appl. Mech. Engrg. 
		\end{thebibliography}
	\end{frame}
	
\end{document}
